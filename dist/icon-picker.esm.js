/*! Icon Picker 0.0.7 MIT | https://github.com/AppoloDev/icon-picker */var t={};function e(t,e,i,s){Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);for(const n of e)for(const e of i)n[t](e,s);return[].slice.call(arguments,1)}t.d=(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);const i=e.bind(null,"addEventListener"),s=e.bind(null,"removeEventListener");function n(t){return t&&"object"==typeof t&&!Array.isArray(t)}function r(t,e){let i=Object.assign({},t);return n(t)&&n(e)&&Object.keys(e).forEach(s=>{n(e[s])?s in t?i[s]=r(t[s],e[s]):Object.assign(i,{[s]:e[s]}):Object.assign(i,{[s]:e[s]})}),i}function o(t,e){var i;return function(){var s=arguments,n=this;clearTimeout(i),i=setTimeout(function(){t.apply(n,s)},e)}}function a(t,e){return Object.keys(t).find(i=>t[i]===e)}class l{constructor({container:t,items:e,renderItem:i,i18nEmpty:s="No results",estimateItemSize:n={width:42,height:42},gaps:r={x:6,y:6},bufferRows:o=3}){if(!t)throw new Error("VirtualIconGrid: container is required");if(!i)throw new Error("VirtualIconGrid: renderItem is required");this.container=t,this.items=Array.isArray(e)?e.slice():[],this.renderItem=i,this.i18nEmpty=s,this.estimate=n,this.bufferRows=Math.max(0,0|o),this._query="",this._indexed=[],this._filtered=[],this._cols=1,this._itemW=this.estimate.width,this._itemH=this.estimate.height,this._gapX=r.x,this._gapY=r.y,this._mounted=!1,this._onScroll=this._onScroll.bind(this),this._onResize=this._onResize.bind(this),this._inner=document.createElement("div"),this._inner.className="vs-inner",this._emptyEl=document.createElement("div"),this._emptyEl.className="is-empty",this._emptyEl.textContent=this.i18nEmpty,this._lastRange={start:-1,end:-1},this._resizeObs=null,this._buildIndex(),this._filtered=this.items}mount(){if(!this._mounted){for(this._mounted=!0;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.container.classList.add("virtual-scroll"),this.container.appendChild(this._inner),this._measureItem(),this._computeLayout(),this._updateInnerHeight(),this._renderWindow(),this._toggleEmptyMessage(),this.container.addEventListener("scroll",this._onScroll,{passive:!0}),"ResizeObserver"in window?(this._resizeObs=new ResizeObserver(this._onResize),this._resizeObs.observe(this.container)):window.addEventListener("resize",this._onResize)}}destroy(){this._mounted&&(this._mounted=!1,this.container.removeEventListener("scroll",this._onScroll),this._resizeObs?(this._resizeObs.disconnect(),this._resizeObs=null):window.removeEventListener("resize",this._onResize),this._inner.replaceChildren(),this._emptyEl&&this._emptyEl.parentNode&&this._emptyEl.remove())}setItems(t){this.items=Array.isArray(t)?t.slice():[],this._buildIndex(),this._applyFilter()}setQuery(t){const e=(t||"").toLowerCase();e!==this._query&&(this._query=e,this._applyFilter())}_buildIndex(){this._indexed=this.items.map(t=>({value:t.value,text:[t.value,...t.categories||[]].join(" ").toLowerCase(),ref:t}))}_applyFilter(){if(this._query){const t=this._query;this._filtered=this._indexed.filter(e=>e.text.includes(t)).map(t=>t.ref)}else this._filtered=this.items;this._toggleEmptyMessage(),this._updateInnerHeight(),this._lastRange.start=-1,this._renderWindow()}_toggleEmptyMessage(){this._filtered.length>0?this._emptyEl.parentNode&&this._emptyEl.remove():this._emptyEl.parentNode||this.container.appendChild(this._emptyEl)}_measureItem(){const t=this.items[0]||{value:"sample"},e=this.renderItem(t);e.style.position="absolute",e.style.visibility="hidden",e.classList.add("vs-item"),this._itemW=this.estimate.width,this._itemH=this.estimate.height,e.remove()}_computeLayout(){const t=this.container.clientWidth||1,e=this._itemW+this._gapX,i=Math.max(1,Math.floor((t+this._gapX)/e));this._cols=i}_totalRows(){return Math.ceil(this._filtered.length/this._cols)}_updateInnerHeight(){const t=this._totalRows()*(this._itemH+this._gapY)-this._gapY;this._inner.style.height=Math.max(0,t).toString()+"px";const e=this._inner.parentElement.offsetWidth-this._inner.parentElement.clientWidth;this._inner.parentElement.style.width=Math.max(this._cols*(this._itemW+this._gapX)-this._gapX+e)+"px"}_onResize(){const t=this._cols;this._computeLayout(),this._cols!==t?(this._updateInnerHeight(),this._lastRange.start=-1,this._renderWindow()):this._renderWindow()}_onScroll(){this._renderWindow()}_renderWindow(){if(!this._filtered.length)return this._inner.replaceChildren(),void(this._lastRange={start:-1,end:-1});const t=this.container.scrollTop,e=this.container.clientHeight,i=this._itemH+this._gapY,s=Math.max(0,Math.floor(t/i)-this.bufferRows),n=Math.floor((t+e)/i)+this.bufferRows,r=s*this._cols,o=Math.min(this._filtered.length,(n+1)*this._cols);if(r===this._lastRange.start&&o===this._lastRange.end)return;this._lastRange={start:r,end:o};const a=document.createDocumentFragment();for(let t=r;t<o;t++){const e=this._filtered[t];if(!e)continue;const i=Math.floor(t/this._cols),s=t%this._cols*(this._itemW+this._gapX),n=i*(this._itemH+this._gapY),r=this.renderItem(e);r.classList.add("vs-item"),r.style.transform=`translate(${s}px, ${n}px)`,r.style.width=this._itemW+"px",r.style.height=this._itemH+"px",a.appendChild(r)}this._inner.replaceChildren(a)}}const h=t=>{const{theme:e,i18n:i,closeOnSelect:s}=t,n=function(t){const e=(t,e)=>{const i=t.getAttribute(e);return t.removeAttribute(e),i},i=(t,s={})=>{const n=e(t,"data-element");n&&(s[n]=t);for(const n of Array.from(t.children)){const t=e(n,"data-interaction");t&&t&&(s[t]=n),i(n,s)}return s};return i(function(t){if(window.DOMParser)return(new DOMParser).parseFromString(t,"text/html").body.firstElementChild;const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(t))}(`\n        <div class="icon-picker-modal" tabindex="-1" data-theme="${e}" data-element="modal" aria-modal="true" aria-labelledby="Icon picker modal" role="dialog">\n            <div class="icon-picker-modal__dialog">\n                <div class="icon-picker-modal__header" data-element="header">\n                    ${"string"==typeof i["text:title"]&&""!==i["text:title"]?`<h2>${i["text:title"]}</h2>`:""}\n                    \n                    <button class="icon-picker-modal--close" aria-label="Close" data-interaction="close">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke-width="1.5">\n                          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="M6.758 17.243 12.001 12m5.243-5.243L12 12m0 0L6.758 6.757M12.001 12l5.243 5.243"/>\n                        </svg>\n                    </button>\n                </div>\n                \n                <input placeholder="${i["input:placeholder"]}" class="icon-picker-modal__search" aria-label="${i["input:placeholder"]}" data-interaction="search">\n                \n                <div class="icon-picker-modal__content" data-element="content"></div>\n            \n                ${s?"":`\n                    <div class="icon-picker-modal__footer" data-element="footer">\n                        <button type="button" class="picker-save" data-interaction="save">${i["btn:save"]}</button>\n                    </div>`}\n            </div>\n        </div>\n    `);return e.includes("bootstrap")&&(n.save?.classList.add("btn","btn-primary"),n.search.classList.add("form-control")),n};const c="https://raw.githubusercontent.com/iconify/icon-sets/master/json",d={"Material Design Icons":{key:"mdi",prefix:"mdi mdi-",url:`${c}/mdi.json`},"FontAwesome Brands 6":{key:"fa6-brands",prefix:"fab fa-",url:`${c}/fa6-brands.json`},"FontAwesome Solid 6":{key:"fa6-solid",prefix:"fas fa-",url:`${c}/fa6-solid.json`},"FontAwesome Regular 6":{key:"fa6-regular",prefix:"far fa-",url:`${c}/fa6-regular.json`},Iconoir:{key:"iconoir",prefix:"iconoir-",url:`${c}/iconoir.json`}};function u(t){let e=Object.create({});return Array.isArray(t)&&t.forEach(t=>{!function(t){return d.hasOwnProperty(t)}(t)?t.key&&(e[t.key]=t):e[d[t].key]=d[t]}),e}class m{virtualIconGrid=null;availableIcons=[];static DEFAULT_OPTIONS={theme:"default",closeOnSelect:!0,defaultValue:null,iconSource:[],i18n:{"input:placeholder":"Search icon…","text:title":"Select icon","text:empty":"No results found…","text:loading":"Loading…","btn:save":"Save"},itemSize:50,iconSize:32};_eventListener={select:[],save:[],show:[],clear:[],hide:[],loaded:[]};constructor(t,e={}){this.options=r(m.DEFAULT_OPTIONS,e),this.element=t,this.iconsLoading=!0,this._preBuild(),this.element&&this.options.iconSource.length>0?(this._binEvents(),this._renderdIcons(),this._createModal()):this._catchError("iconSourceMissing")}_preBuild(){var t;this.element=(t=this.element)instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):null,this.root=h(this.options),!Array.isArray(this.options.iconSource)&&this.options.iconSource.length>0&&(this.options.iconSource=[this.options.iconSource]),this.virtualIconGrid=this.virtualIconGrid||new l({container:this.root.content,items:this.availableIcons??[],renderItem:t=>this.renderItem(t),i18nEmpty:this.options.i18n["text:empty"],estimateItemSize:{width:this.options.itemSize,height:this.options.itemSize},bufferRows:4})}renderItem(t){const e=document.createElement("button");return e.type="button",e.className=`icon-element ${t.value}`,e.title=t.value,e.setAttribute("aria-label",t.value),e.dataset.value=t.inputValue,e.innerHTML=t.body,e.addEventListener("click",e=>t.onSelect&&t.onSelect(e)),e}ensureVirtualMounted=()=>{requestAnimationFrame(()=>{this.virtualIconGrid._mounted?this.virtualIconGrid._onResize&&this.virtualIconGrid._onResize():this.virtualIconGrid.mount();const t=(this.root.search?.value||"").trim().toLowerCase();this.virtualIconGrid.setQuery(t),this.virtualIconGrid.setItems(this.availableIcons)})};_binEvents(){const{options:t,root:e,element:s,virtualIconGrid:n}=this,r=o(t=>{const e=(t.target.value||"").trim().toLowerCase();n&&n.setQuery(e)},120);this._eventBindings=[i(s,"click",()=>{this.show(),this.ensureVirtualMounted()}),i(e.close,"click",()=>this.hide()),i(e.modal,"click",t=>{t.target===e.modal&&this.hide()}),i(e.search,"keyup",o(r,250))],t.closeOnSelect||this._eventBindings.push(i(e.save,"click",()=>this._onSave()))}hide(){return!!this.isOpen()&&(this.root.modal.classList.remove("is-visible"),this._emit("hide"),this)}show(){return!this.isOpen()&&(this.root.modal.classList.add("is-visible"),this._emit("show"),this)}clear(){this.initialized&&this.currentlySelectName&&(this.currentlySelectName=null,this._emit("clear"))}isOpen(){return this.root.modal.classList.contains("is-visible")}iconsLoaded(){return!this.loadingState}destroy(t=!0){this.initialized=!1,this._eventBindings.forEach(t=>s(...t)),t&&Object.keys(this).forEach(t=>delete this[t])}_emit(t,...e){this._eventListener[t].forEach(t=>t(...e,this))}on(t,e){return void 0!==this._eventListener[t]&&(this._eventListener[t].push(e),this)}off(t,e){const i=this._eventListener[t]||[],s=i.indexOf(e);return~s&&i.splice(s,1),this}_createModal(){document.body.appendChild(this.root.modal),this.initialized=!0}_onSave(){this._setValueInput(),this.hide(),this._emit("save",this.emitValues)}async _renderdIcons(){const{root:t,options:e}=this;let i=null,s=null,n=null;if(this.availableIcons=[],t.content.innerHTML=`<div class="is-loading">${e.i18n["text:loading"]}</div>`,(await this._getIcons()).forEach(t=>{let r=t.iconFormat?t.iconFormat:"svg";for(const[o,l]of Object.entries(t.icons)){const h=document.createElement("button");if(h.title=o,h.className=`icon-element ${o}`,h.dataset.value=t.prefix+o,t.categories&&Object.entries(t.categories).length>0){n=[];for(const[e]of Object.entries(t.categories))t.categories[e].includes(o)&&(n.length>0?n.push(e.toLowerCase()):n=[e.toLowerCase()])}let c;if(t.chars&&(h.dataset.unicode=a(t.chars,o)),"i"!==r&&l.body)if("markup"===r){let t=document.createElement("template");t.innerHTML=l.body,c=t.content}else c=document.createElementNS("http://www.w3.org/2000/svg","svg"),c.setAttribute("height",this.options.iconSize.toString()),c.setAttribute("width",this.options.iconSize.toString()),c.setAttribute("viewBox",`0 0 ${l.width?l.width:t.width} ${l.height?l.height:t.height}`),c.innerHTML=l.body;else c=document.createElement("i"),c.setAttribute("class",h.dataset.value);this.availableIcons.push({inputValue:t.prefix+o,value:o,body:c.outerHTML,...n?.length>0&&{categories:n},onSelect:n=>{this.currentlySelectName!==n.currentTarget.firstChild.className&&(n.currentTarget.classList.add("is-selected"),s=n.currentTarget,this.currentlySelectName=s.dataset.value,this.SVGString=c.outerHTML,this.emitValues={name:o,value:this.currentlySelectName,svg:this.SVGString},t.chars&&(this.emitValues.unicode=c.dataset.unicode),this._emit("select",this.emitValues)),i&&i.classList.remove("is-selected"),e.closeOnSelect&&this._onSave(),i=s}})}}),e.defaultValue||this.element.value){let t=document.querySelector(`[data-value="${e.defaultValue?e.defaultValue:this.element.value}"]`)?document.querySelector(`[data-value="${e.defaultValue?e.defaultValue:this.element.value}"]`):document.querySelector(`.${e.defaultValue?e.defaultValue:this.element.value}`),s=t?.dataset.value??"";t?.classList.add("is-selected"),i=t,this.currentlySelectName=s,this.element.value||this._setValueInput()}this.ensureVirtualMounted();const r=t.content.querySelector(".is-loading");r&&r.remove(),this.iconsLoading=!1,this._emit("loaded")}async _getIcons(){const{options:t}=this,e=[];let i=u(t.iconSource);for(const t of Object.values(i))e.push(t.url);return await Promise.all(e.map(t=>fetch(t).then(t=>t.json()))).then(t=>(t.forEach(t=>{i.hasOwnProperty(t.prefix)&&(t.prefix=i[t.prefix].prefix)}),t))}_catchError(t){if("iconSourceMissing"===t)throw Error("No icon source was found.")}_setValueInput(t=this.currentlySelectName){const{element:e}=this;e instanceof HTMLInputElement&&this.currentlySelectName&&(e.value=t)}}export{m as default};